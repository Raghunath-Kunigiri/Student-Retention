<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Advisor Dashboard - Student Retention System</title>
  <link rel="stylesheet" href="../src/styles/variables.css" />
  <link rel="stylesheet" href="../src/styles/cursor.css" />
  <link rel="stylesheet" href="../src/styles/interactions.css" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); min-height: 100vh; display: flex; align-items: start; justify-content: center; padding: 24px; color: #2a2a2a; }
    .dashboard { background: rgba(255,255,255,.95); backdrop-filter: blur(10px); border-radius: 20px; padding: 28px; box-shadow: 0 20px 40px rgba(0,0,0,.12); width: 100%; max-width: 1100px; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .title { display: flex; gap: 12px; align-items: center; }
    .avatar { width: 44px; height: 44px; border-radius: 50%; background: linear-gradient(135deg,#f093fb,#f5576c); color: #fff; display: grid; place-items: center; font-weight: 700; box-shadow: 0 6px 16px rgba(245,87,108,.35); }
    .header h1 { font-size: 22px; color: #333; }
    .header .meta { color: #666; font-size: 13px; margin-top: 2px; }
    .signout { color: #f5576c; text-decoration: none; font-weight: 700; padding: 10px 14px; border-radius: 10px; background: rgba(245,87,108,.08); }
    .signout:hover { background: rgba(245,87,108,.15); }
    .grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
    .card { background: #fff; border: 1px solid #e8ecf2; border-radius: 14px; padding: 18px; box-shadow: 0 8px 24px rgba(0,0,0,.06); }
    .card h2 { font-size: 18px; margin-bottom: 12px; color: #333; }
    .list { display: grid; gap: 10px; }
    .list-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; border: 1px solid #eef1f6; border-radius: 10px; background: #fff7fb; }
    .chip { padding: 4px 10px; border-radius: 999px; font-size: 12px; background: #ffe3ef; color: #b91c1c; }
    .form { display: grid; gap: 12px; }
    input, select { width: 100%; padding: 12px 14px; border: 2px solid #e8ecf2; border-radius: 12px; background: #fff; font-size: 14px; }
    .actions { display: flex; justify-content: end; gap: 10px; }
    .btn { border: 0; border-radius: 12px; padding: 12px 16px; font-weight: 700; cursor: pointer; }
    .btn.primary { background: linear-gradient(135deg,#f093fb,#f5576c); color: #fff; box-shadow: 0 8px 20px rgba(245,87,108,.3); }
    @media (max-width: 900px){ .grid { grid-template-columns: 1fr; } }
  </style>
  <script type="module" src="../src/index.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const email = localStorage.getItem('advisorEmail') || '';
      let fullName = localStorage.getItem('advisorFullName') || '';
      let advisorId = localStorage.getItem('advisorId') || '';

      if ((!fullName || !advisorId) && email){
        try {
          const res = await fetch(`http://localhost:4000/api/entries?type=advisor-profile&email=${encodeURIComponent(email)}&limit=1`);
          if (res.ok){
            const items = await res.json();
            const profile = items && items[0];
            if (profile && profile.data){
              fullName = profile.data.fullName || fullName;
              advisorId = profile.data.advisorId || advisorId;
              localStorage.setItem('advisorFullName', fullName);
              localStorage.setItem('advisorId', advisorId);
            }
          }
        } catch(e) {}
      }

      const initials = (fullName || email || 'A').split(' ').map(w => w[0]).join('').slice(0,2).toUpperCase();
      document.getElementById('welcome').textContent = `Welcome, Advisor : ${fullName || initials}`;
      document.getElementById('advisor-id-line').textContent = advisorId ? `ID: ${advisorId}` : '';
      document.getElementById('avatar').textContent = initials || 'A';
    });
  </script>
</head>
<body>
  <canvas id="particle-canvas" style="position:fixed;inset:0;pointer-events:none;z-index:9998;"></canvas>
  <div class="dashboard">
    <div class="header">
      <div class="title">
        <div id="avatar" class="avatar">A</div>
        <div>
          <h1 id="welcome">Welcome</h1>
          <div id="advisor-id-line" class="meta"></div>
          <small>Advisor Dashboard</small>
        </div>
      </div>
      <a class="signout" href="index.html" onclick="localStorage.clear()">Sign out</a>
    </div>

    <div class="grid">
      <div class="left">
        <div class="card" style="margin-bottom:20px;">
          <h2>My Students (examples)</h2>
          <div class="list">
            <div class="list-item"><span>RK • CS • GPA 3.8</span><span class="chip">On Track</span></div>
            <div class="list-item"><span>Alex • ENG • GPA 3.2</span><span class="chip">Monitor</span></div>
            <div class="list-item"><span>Maya • BUS • GPA 3.6</span><span class="chip">On Track</span></div>
          </div>
        </div>
        <div class="card">
          <h2>Recent Help Requests</h2>
          <div class="list">
            <div class="list-item"><span>Housing assistance needed (RK)</span><span class="chip">New</span></div>
            <div class="list-item"><span>Financial aid query (Alex)</span><span class="chip">Pending</span></div>
          </div>
        </div>
      </div>
      <div class="right">
        <div class="card">
          <h2>Find Student</h2>
          <form class="form" onsubmit="event.preventDefault(); const id=this.querySelector('#sid').value; if(id){ location.href='student-dashboard.html'; localStorage.setItem('studentId', id);} ">
            <input id="sid" placeholder="Student ID" required />
            <div class="actions"><button class="btn primary" type="submit">Open Dashboard</button></div>
          </form>
        </div>
      </div>
    </div>
  </div>
</body>
</html>


